#include "raylib.h"

void colisao (float *x, float *y)
{
    //colisão com as paredes:
    //é bom colocar essa parte antes de desenhar o personagem pra visualmente ela só ficar parada
            
    //lado esquerdo:
    if (*x+10 <= 0) 
        *x += 5.0f;
            
    //lado direito:
    if (*x+40 >= 800)
        *x -= 5.0f;
            
    //cima:
    if (*y+5 <= 0)
        *y += 5.0f;
            
    //baixo:
    if (*y+50 >= 450)
        *y -= 5.0f;
}


typedef struct personagem
{
    Image visual; 
    Vector2 pos;//posição(x,y)
    Rectangle hitbox;
    float veloci;
    Texture2D textura;
}personagem;


void movimentofujona(float *x, float *y)
{
    if(IsKeyDown(KEY_W)||IsKeyDown(KEY_UP))
        *y-=5.0f;
  
    else if(IsKeyDown(KEY_S)||IsKeyDown(KEY_DOWN))
        *y+=5.0f;
        
    else if(IsKeyDown(KEY_A)||IsKeyDown(KEY_LEFT))
        *x-=5.0f;
        
    else if(IsKeyDown(KEY_D)||IsKeyDown(KEY_RIGHT))
        *x+=5.0f;
}



int main(void)
{
    const int screenWidth = 800;
    const int screenHeight = 450;

    InitWindow(screenWidth, screenHeight, "Colisão");
    
    SetTargetFPS(60);                   
    
    personagem perso[50];

    perso[0].visual = LoadImage("/raylib/RunningGirl/PERSONAGENS/show (54).png");
    perso[0].textura = LoadTextureFromImage(perso[0].visual);
    perso[0].hitbox.x = 370;
    perso[0].hitbox.y = 225;
    perso[0].hitbox.width = 40;
    perso[0].hitbox.height = 50;
    
    perso[1].visual = LoadImage("/raylib/RunningGirl/PERSONAGENS/show (54).png");
    perso[1].textura = LoadTextureFromImage(perso[0].visual);
    perso[1].hitbox.x = 300;
    perso[1].hitbox.y = 200;
    perso[1].hitbox.width = 40;
    perso[1].hitbox.height = 50;
    
    while (!WindowShouldClose())
    {
        BeginDrawing();

        ClearBackground(SKYBLUE); // mesmo background aleatorio só pra rodar
             
        movimentofujona(&perso[0].hitbox.x, &perso[0].hitbox.y);
                        
        colisao (&perso[0].hitbox.x, &perso[0].hitbox.y);
            
        //colisão com o retângulo:
        if (CheckCollisionRecs (perso[0].hitbox, perso[1].hitbox))
        {
            //indo pela direita do objeto
            if (perso[0].hitbox.x+5 == perso[1].hitbox.x + perso[1].hitbox.width) //esse +5 é só pra ficar visualmente melhor
                perso[0].hitbox.x += 5.0f;
            
            //indo pela esquerda do objeto
            if (perso[0].hitbox.x + perso[0].hitbox.width == perso[1].hitbox.x+5) //esse +5 é só pra ficar visualmente melhor
                perso[0].hitbox.x -= 5.0f;
            
            //indo por baixo
            if (perso[0].hitbox.y+5 == perso[1].hitbox.y + perso[1].hitbox.height) //esse +5 é só pra ficar visualmente melhor
                perso[0].hitbox.y += 5.0f;
            
            //indo por cima
            if (perso[0].hitbox.y + perso[0].hitbox.height == perso[1].hitbox.y+5) //esse +5 é só pra ficar visualmente melhor
                perso[0].hitbox.y -= 5.0f;
        }
        
        //os retangulos das hitboxs
        DrawRectangleRec (perso[0].hitbox, RAYWHITE);
        
        DrawRectangleRec (perso[1].hitbox, RAYWHITE);
 
        //as boneca
        DrawTexture(perso[0].textura,perso[0].hitbox.x,perso[0].hitbox.y,RAYWHITE);
        
        DrawTexture(perso[1].textura,perso[1].hitbox.x,perso[1].hitbox.y,RAYWHITE);

        
        EndDrawing();
        
    }
    
    CloseWindow();        

    return 0;
}
